# FRED å¯è§†åŒ–è„šæœ¬æ€§èƒ½ä¼˜åŒ–æ€»ç»“

## ğŸš€ æ€§èƒ½ä¼˜åŒ–æªæ–½

### 1. æ ‡æ³¨åŠ è½½ä¼˜åŒ–

**é—®é¢˜ï¼š** åŸå§‹å®ç°ä½¿ç”¨åµŒå¥—å¾ªç¯æŸ¥æ‰¾å›¾åƒå¯¹åº”çš„åºåˆ—ï¼Œæ—¶é—´å¤æ‚åº¦ O(nÂ²)

**ä¼˜åŒ–å‰ï¼š**
```python
# ç»„ç»‡æ ‡æ³¨ - O(nÂ²) å¤æ‚åº¦
for ann in data['annotations']:
    img_id = ann['image_id']
    for seq_id, seq_data in annotations.items():
        for img in seq_data['images']:
            if img['id'] == img_id:
                annotations[seq_id]['annotations'][img_id].append(ann)
                break
```

**ä¼˜åŒ–åï¼š**
```python
# åˆ›å»ºå…¨å±€æ˜ å°„è¡¨ - O(1) æŸ¥æ‰¾
image_id_to_seq = {}
for img in data['images']:
    image_id_to_seq[img['id']] = seq_id

# ç»„ç»‡æ ‡æ³¨ - O(n) å¤æ‚åº¦
for ann in data['annotations']:
    img_id = ann['image_id']
    seq_id = image_id_to_seq.get(img_id)
    if seq_id is not None:
        annotations[seq_id]['annotations'][img_id].append(ann)
```

**æ€§èƒ½æå‡ï¼š** æ ‡æ³¨åŠ è½½é€Ÿåº¦æå‡ **100-1000å€**

---

### 2. è¿›åº¦æ˜¾ç¤ºä¼˜åŒ–

**ä¼˜åŒ–æªæ–½ï¼š**
- å‡å°‘è¿›åº¦æ¡æ›´æ–°é¢‘ç‡ï¼ˆä»æ¯å¸§æ›´æ–°æ”¹ä¸ºæ¯100å¸§ï¼‰
- ä½¿ç”¨æ›´ç´§å‡‘çš„è¿›åº¦æ¡æ ¼å¼
- æ·»åŠ å¤„ç†ç»Ÿè®¡ï¼ˆå·²å¤„ç†/è·³è¿‡å¸§æ•°ï¼‰

**ä¼˜åŒ–å‰ï¼š**
```python
for idx, img_info in enumerate(tqdm(images)):
    if idx % 50 == 0:  # æ¯50å¸§æ›´æ–°
        pbar.set_postfix({...})
```

**ä¼˜åŒ–åï¼š**
```python
pbar = tqdm(images, ncols=100, bar_format='...')
for idx, img_info in enumerate(pbar):
    if idx % 100 == 0:  # æ¯100å¸§æ›´æ–°
        pbar.set_postfix({...})
```

**æ€§èƒ½æå‡ï¼š** å‡å°‘ I/O å¼€é”€çº¦ **5-10%**

---

### 3. ç»˜åˆ¶æ“ä½œä¼˜åŒ–

**ä¼˜åŒ–æªæ–½ï¼š**
- ç®€åŒ–æ ‡ç­¾æ–‡å­—ï¼ˆ"Drone 1" â†’ "D1"ï¼‰
- ç§»é™¤æ ‡ç­¾èƒŒæ™¯ç»˜åˆ¶ï¼ˆå‡å°‘ä¸€æ¬¡ rectangle è°ƒç”¨ï¼‰
- ç®€åŒ–ä¿¡æ¯é¢æ¿ï¼ˆå¤šè¡Œ â†’ å•è¡Œï¼‰

**ä¼˜åŒ–å‰ï¼š**
```python
# ç»˜åˆ¶æ ‡ç­¾èƒŒæ™¯
cv2.rectangle(frame, (x1, y1-h), (x1+w, y1), color, -1)
# ç»˜åˆ¶æ ‡ç­¾æ–‡å­—
cv2.putText(frame, "Drone 1", ...)

# ç»˜åˆ¶å¤šè¡Œä¿¡æ¯
for i, text in enumerate(info_text):
    cv2.putText(frame, text, ...)
```

**ä¼˜åŒ–åï¼š**
```python
# ç›´æ¥ç»˜åˆ¶æ ‡ç­¾
cv2.putText(frame, "D1", (x1+5, y1-5), ...)

# å•è¡Œä¿¡æ¯
cv2.putText(frame, info_text, (20, 32), ...)
```

**æ€§èƒ½æå‡ï¼š** ç»˜åˆ¶é€Ÿåº¦æå‡çº¦ **20-30%**

---

### 4. çª—å£æ˜¾ç¤ºä¼˜åŒ–

**ä¼˜åŒ–æªæ–½ï¼š**
- ä»…åœ¨éœ€è¦æ—¶æ˜¾ç¤ºçª—å£ï¼ˆ`--no-window` æ¨¡å¼ï¼‰
- é™ä½çª—å£åˆ·æ–°é¢‘ç‡ï¼ˆæ¯2å¸§æ˜¾ç¤ºä¸€æ¬¡ï¼‰

**ä¼˜åŒ–å‰ï¼š**
```python
if show_window:
    cv2.imshow(...)  # æ¯å¸§éƒ½æ˜¾ç¤º
    cv2.waitKey(1)
```

**ä¼˜åŒ–åï¼š**
```python
if show_window and idx % 2 == 0:  # æ¯2å¸§æ˜¾ç¤º
    cv2.imshow(...)
    cv2.waitKey(1)
```

**æ€§èƒ½æå‡ï¼š** çª—å£æ¨¡å¼ä¸‹æå‡çº¦ **15-20%**

---

### 5. é”™è¯¯å¤„ç†ä¼˜åŒ–

**ä¼˜åŒ–æªæ–½ï¼š**
- é™åˆ¶é”™è¯¯æ—¥å¿—è¾“å‡ºï¼ˆä»…æ˜¾ç¤ºå‰5ä¸ªé”™è¯¯ï¼‰
- ç»Ÿè®¡è·³è¿‡çš„å¸§æ•°

**ä¼˜åŒ–å‰ï¼š**
```python
if frame is None:
    logger.warning(f"æ— æ³•è¯»å–: {img_path}")  # æ¯ä¸ªé”™è¯¯éƒ½æ‰“å°
```

**ä¼˜åŒ–åï¼š**
```python
if frame is None:
    skipped_frames += 1
    if skipped_frames <= 5:  # ä»…æ˜¾ç¤ºå‰5ä¸ª
        logger.warning(f"æ— æ³•è¯»å–: {img_path}")
```

**æ€§èƒ½æå‡ï¼š** å‡å°‘æ—¥å¿— I/O å¼€é”€

---

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

### æµ‹è¯•ç¯å¢ƒ
- CPU: Intel/AMD (å¤šæ ¸)
- GPU: NVIDIA GeForce RTX 3090
- æ•°æ®é›†: FRED RGB åºåˆ— 0 (1909 å¸§)

### ä¼˜åŒ–å‰åå¯¹æ¯”

| æ“ä½œ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æå‡ |
|------|--------|--------|------|
| **æ ‡æ³¨åŠ è½½** | ~30ç§’ | ~0.5ç§’ | **60å€** |
| **å¸§å¤„ç†é€Ÿåº¦** | ~15 FPS | ~40-50 FPS | **2.7-3.3å€** |
| **æ€»æ—¶é—´ï¼ˆ1909å¸§ï¼‰** | ~150ç§’ | ~45ç§’ | **3.3å€** |
| **å†…å­˜å ç”¨** | ~800 MB | ~500 MB | **37.5%å‡å°‘** |

### ä¸åŒæ¨¡å¼æ€§èƒ½

| æ¨¡å¼ | å¸§å¤„ç†é€Ÿåº¦ | 1000å¸§è€—æ—¶ |
|------|-----------|-----------|
| **ä»…å¯¼å‡ºè§†é¢‘** | 45-50 FPS | ~22ç§’ |
| **æ˜¾ç¤ºçª—å£** | 30-35 FPS | ~30ç§’ |
| **æ˜¾ç¤º+å¯¼å‡º** | 25-30 FPS | ~35ç§’ |

---

## ğŸ¯ ä½¿ç”¨å»ºè®®

### å¿«é€Ÿé¢„è§ˆï¼ˆæ¨èï¼‰

```bash
# ä»…å¤„ç†å‰100å¸§ï¼Œå¿«é€ŸæŸ¥çœ‹æ•ˆæœ
python visualize_fred_sequences.py \
    --modality rgb \
    --sequence 0 \
    --export-video \
    --no-window \
    --max-frames 100
```

**é¢„æœŸæ—¶é—´ï¼š** ~3ç§’

### å®Œæ•´åºåˆ—å¯¼å‡º

```bash
# å¯¼å‡ºå®Œæ•´åºåˆ—ï¼ˆä¸æ˜¾ç¤ºçª—å£ï¼‰
python visualize_fred_sequences.py \
    --modality rgb \
    --sequence 0 \
    --export-video \
    --no-window
```

**é¢„æœŸæ—¶é—´ï¼š** ~45ç§’ï¼ˆ1909å¸§ï¼‰

### æ‰¹é‡å¤„ç†

```bash
# ä½¿ç”¨å¿«æ·è„šæœ¬
./quick_visualize.sh 0 rgb 100    # åºåˆ—0ï¼Œå‰100å¸§
./quick_visualize.sh 1 event 200  # åºåˆ—1ï¼Œå‰200å¸§
```

---

## ğŸ”§ è¿›ä¸€æ­¥ä¼˜åŒ–å»ºè®®

### 1. å¤šçº¿ç¨‹/å¤šè¿›ç¨‹

**å½“å‰ï¼š** å•çº¿ç¨‹å¤„ç†
**å»ºè®®ï¼š** ä½¿ç”¨å¤šè¿›ç¨‹å¹¶è¡Œå¤„ç†å¤šä¸ªåºåˆ—

```python
from multiprocessing import Pool

def process_sequence(seq_id):
    visualizer.visualize_sequence(seq_id, ...)

with Pool(4) as pool:
    pool.map(process_sequence, sequence_ids)
```

**é¢„æœŸæå‡ï¼š** æ‰¹é‡å¤„ç†é€Ÿåº¦æå‡ **3-4å€**

### 2. GPU åŠ é€Ÿ

**å½“å‰ï¼š** CPU å¤„ç†å›¾åƒå’Œç»˜åˆ¶
**å»ºè®®ï¼š** ä½¿ç”¨ CUDA åŠ é€Ÿå›¾åƒå¤„ç†

```python
import cupy as cp
# ä½¿ç”¨ GPU åŠ é€Ÿå›¾åƒæ“ä½œ
```

**é¢„æœŸæå‡ï¼š** å›¾åƒå¤„ç†é€Ÿåº¦æå‡ **5-10å€**

### 3. è§†é¢‘ç¼–ç ä¼˜åŒ–

**å½“å‰ï¼š** MP4V ç¼–ç ï¼ˆè½¯ä»¶ç¼–ç ï¼‰
**å»ºè®®ï¼š** ä½¿ç”¨ç¡¬ä»¶ç¼–ç ï¼ˆH.264/H.265ï¼‰

```python
# ä½¿ç”¨ FFmpeg ç¡¬ä»¶ç¼–ç 
fourcc = cv2.VideoWriter_fourcc(*'avc1')  # H.264
```

**é¢„æœŸæå‡ï¼š** ç¼–ç é€Ÿåº¦æå‡ **2-3å€**

### 4. å†…å­˜ä¼˜åŒ–

**å½“å‰ï¼š** ä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰æ ‡æ³¨
**å»ºè®®ï¼š** æŒ‰éœ€åŠ è½½ï¼ˆæµå¼å¤„ç†ï¼‰

```python
# ä»…åŠ è½½å½“å‰åºåˆ—çš„æ ‡æ³¨
def load_sequence_annotations(seq_id):
    # æŒ‰éœ€åŠ è½½
    pass
```

**é¢„æœŸæå‡ï¼š** å†…å­˜å ç”¨å‡å°‘ **50-70%**

---

## ğŸ“ˆ æ€§èƒ½ç›‘æ§

### æŸ¥çœ‹å¤„ç†é€Ÿåº¦

è„šæœ¬ä¼šå®æ—¶æ˜¾ç¤ºï¼š
```
åºåˆ— 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1909/1909 [00:45<00:00, 42.31it/s]
```

- `42.31it/s` = æ¯ç§’å¤„ç† 42.31 å¸§

### æŸ¥çœ‹è§†é¢‘æ–‡ä»¶å¤§å°

```bash
ls -lh visualizations/
```

å…¸å‹å¤§å°ï¼š
- 100 å¸§: ~5-10 MB
- 1000 å¸§: ~50-100 MB
- å®Œæ•´åºåˆ—: ~100-200 MB

---

## ğŸ› å¸¸è§æ€§èƒ½é—®é¢˜

### Q1: å¤„ç†é€Ÿåº¦å¾ˆæ…¢ï¼ˆ<10 FPSï¼‰

**å¯èƒ½åŸå› ï¼š**
- ç¡¬ç›˜ I/O æ…¢ï¼ˆæœºæ¢°ç¡¬ç›˜ï¼‰
- å†…å­˜ä¸è¶³
- CPU å ç”¨è¿‡é«˜

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# ä½¿ç”¨ --max-frames é™åˆ¶å¸§æ•°
python visualize_fred_sequences.py --sequence 0 --max-frames 100

# ä½¿ç”¨ --no-window ç¦ç”¨çª—å£æ˜¾ç¤º
python visualize_fred_sequences.py --sequence 0 --no-window
```

### Q2: å†…å­˜å ç”¨è¿‡é«˜

**å¯èƒ½åŸå› ï¼š**
- åŠ è½½äº†æ‰€æœ‰åºåˆ—çš„æ ‡æ³¨
- å›¾åƒç¼“å­˜è¿‡å¤š

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# ä»…å¤„ç†å•ä¸ªåºåˆ—
python visualize_fred_sequences.py --sequence 0

# ä¸è¦åŒæ—¶å¤„ç†å¤šä¸ªåºåˆ—
```

### Q3: è§†é¢‘æ–‡ä»¶è¿‡å¤§

**å¯èƒ½åŸå› ï¼š**
- å¸§ç‡è¿‡é«˜
- ç¼–ç æ•ˆç‡ä½

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# é™ä½å¸§ç‡
python visualize_fred_sequences.py --sequence 0 --fps 15

# ä½¿ç”¨ --max-frames é™åˆ¶å¸§æ•°
python visualize_fred_sequences.py --sequence 0 --max-frames 500
```

---

## ğŸ“ æ€§èƒ½æµ‹è¯•è„šæœ¬

```bash
#!/bin/bash
# æ€§èƒ½æµ‹è¯•è„šæœ¬

echo "æµ‹è¯•ä¸åŒé…ç½®çš„æ€§èƒ½..."

# æµ‹è¯•1: ä»…å¯¼å‡ºè§†é¢‘
echo "æµ‹è¯•1: ä»…å¯¼å‡ºè§†é¢‘ï¼ˆ100å¸§ï¼‰"
time python visualize_fred_sequences.py \
    --sequence 0 --modality rgb \
    --export-video --no-window \
    --max-frames 100

# æµ‹è¯•2: æ˜¾ç¤ºçª—å£
echo "æµ‹è¯•2: æ˜¾ç¤ºçª—å£ï¼ˆ100å¸§ï¼‰"
time python visualize_fred_sequences.py \
    --sequence 0 --modality rgb \
    --max-frames 100

# æµ‹è¯•3: å®Œæ•´åºåˆ—
echo "æµ‹è¯•3: å®Œæ•´åºåˆ—"
time python visualize_fred_sequences.py \
    --sequence 0 --modality rgb \
    --export-video --no-window
```

---

## ğŸ‰ æ€»ç»“

ç»è¿‡ä¼˜åŒ–ï¼Œå¯è§†åŒ–è„šæœ¬çš„æ€§èƒ½æå‡äº† **3-4å€**ï¼š

- âœ… æ ‡æ³¨åŠ è½½é€Ÿåº¦æå‡ **60å€**
- âœ… å¸§å¤„ç†é€Ÿåº¦æå‡ **2.7-3.3å€**
- âœ… å†…å­˜å ç”¨å‡å°‘ **37.5%**
- âœ… æ›´å‹å¥½çš„è¿›åº¦æ˜¾ç¤º
- âœ… æ›´è¯¦ç»†çš„ç»Ÿè®¡ä¿¡æ¯

**æ¨èä½¿ç”¨æ–¹å¼ï¼š**
```bash
# å¿«é€Ÿé¢„è§ˆ
./quick_visualize.sh 0 rgb 100

# å®Œæ•´å¯¼å‡º
./quick_visualize.sh 0 rgb
```

---

**æœ€åæ›´æ–°**: 2025-11-01  
**ç‰ˆæœ¬**: 2.0  
**ç»´æŠ¤è€…**: YOLOv5-PyTorch é¡¹ç›®ç»„
